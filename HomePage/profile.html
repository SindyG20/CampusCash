<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Campus Cash — Profile</title>
  <style>
    :root{--bg:#f4f6f8;--card:#fff;--accent:#0b74da;--muted:#6b7280}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#111}
    .container{max-width:960px;margin:40px auto;padding:20px}
    .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .brand{font-weight:700;font-size:1.25rem}
    .nav{display:flex;gap:16px}
    .nav a{text-decoration:none;color:#374151;font-weight:500}
    .nav a:hover{color:var(--accent)}

    .card{background:var(--card);border-radius:12px;box-shadow:0 6px 20px rgba(12,20,40,0.06);padding:24px;display:grid;grid-template-columns:140px 1fr;gap:20px;align-items:start}
    .avatar{width:120px;height:120px;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,#e6eefc,#f7fbff);display:flex;align-items:center;justify-content:center;font-size:3rem;color:var(--muted)}
    .info h2{margin:0 0 6px 0;font-size:1.25rem}
    .info p{margin:0 4px 10px 0;color:var(--muted)}

    .meta{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap}
    .meta .chip{background:#f3f4f6;padding:8px 12px;border-radius:999px;font-size:0.9rem;color:#374151}

    .actions{display:flex;gap:8px;align-items:center;position:relative}
    .btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;color:var(--accent);border:1px solid rgba(11,116,218,0.12)}
    .settings-btn{background:transparent;border:0;cursor:pointer;padding:8px;border-radius:8px}

    /* Dropdown */
    .dropdown{position:absolute;top:110%;right:0;background:var(--card);border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,0.1);display:none;flex-direction:column;min-width:200px;z-index:50}
    .dropdown button{background:none;border:0;padding:12px 16px;text-align:left;cursor:pointer;font-size:0.95rem;color:#111}
    .dropdown button:hover{background:#f3f4f6}

    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(3,7,18,0.45);display:none;align-items:center;justify-content:center;padding:20px}
    .modal{background:var(--card);border-radius:12px;max-width:720px;width:100%;padding:20px;box-shadow:0 12px 40px rgba(8,10,20,0.3)}
    .modal h3{margin:0 0 12px}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:0.9rem;margin-bottom:6px;color:#111}
    input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ee;font-size:0.95rem}
    textarea{min-height:80px}
    .modal-footer{display:flex;justify-content:flex-end;gap:8px;margin-top:12px}
    .small{font-size:0.85rem;color:var(--muted)}

    @media (max-width:700px){
      .card{grid-template-columns:1fr;}
      .form-grid{grid-template-columns:1fr}
    }

    /* success toast */
    .toast{position:fixed;right:20px;bottom:20px;background:#111;color:#fff;padding:12px 16px;border-radius:10px;display:none}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <img src="" alt="" width="40" height="40" style="border-radius:8px;background:linear-gradient(90deg,#0b74da,#00c6ff)"/>
        <div class="brand">Campus Cash</div>
      </div>
      <div class="nav">
        <a href="home.html">Home</a>
        <a href="profile.html">Profile</a>
        <a href="#">Accounts</a>
      </div>
      <div class="actions">
        <button id="settingsToggle" class="btn" title="Settings">Settings ▾</button>
        <div id="settingsDropdown" class="dropdown">
          <button id="editProfile">Edit Profile</button>
          <button id="blockCard">Block Card</button>
          <button id="replaceCard">Replace Card</button>
          <button id="cardSettings">Card Settings</button>
          <button id="cardLimits">Card Limits</button>
          <button id="reportLost">Report Lost / Stolen Card</button>
        </div>
        <button id="logout" class="btn secondary" title="Logout">Logout</button>
      </div>
    </div>

    <main class="card" role="region" aria-label="User profile">
      <div>
        <div id="avatar" class="avatar" aria-hidden="true">SG</div>
      </div>
      <div class="info">
        <h2 id="displayName">Sindy Gumede</h2>
        <p id="displayEmail">sindyg@example.com</p>
        <div class="meta">
          <div class="chip" id="displayPhone">+27 82 123 4567</div>
          <div class="chip" id="displayMember">Member since: <span id="displaySince">2024-05-02</span></div>
        </div>
        <p class="small" id="displayAddress">123 Rose Street, Johannesburg</p>
      </div>
    </main>

  </div>

  <!-- Modal -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <h3>Edit profile</h3>
      <form id="profileForm">
        <div class="form-grid">
          <div>
            <label for="firstName">First name</label>
            <input id="firstName" name="firstName" type="text" required />
          </div>
          <div>
            <label for="lastName">Last name</label>
            <input id="lastName" name="lastName" type="text" required />
          </div>
          <div>
            <label for="email">Email</label>
            <input id="email" name="email" type="email" required />
          </div>
          <div>
            <label for="phone">Phone</label>
            <input id="phone" name="phone" type="tel" />
          </div>
          <div style="grid-column:1 / -1">
            <label for="address">Address</label>
            <textarea id="address" name="address"></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" id="cancelBtn" class="btn secondary">Cancel</button>
          <button type="submit" class="btn">Save changes</button>
        </div>
      </form>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Saved</div>

  <script>
    const defaults = {
      firstName: 'Sindy',
      lastName: 'Gumede',
      email: 'sindyg@example.com',
      phone: '+27 82 123 4567',
      address: '123 Rose Street, Johannesburg',
      memberSince: '2024-05-02'
    };

    const storageKey = 'campusCashProfile';

    function loadProfile(){
      try{
        const raw = localStorage.getItem(storageKey);
        return raw ? JSON.parse(raw) : {...defaults};
      }catch(e){
        return {...defaults};
      }
    }

    function saveProfile(profile){
      localStorage.setItem(storageKey, JSON.stringify(profile));
    }

    function updateDisplay(profile){
      document.getElementById('displayName').textContent = profile.firstName + ' ' + profile.lastName;
      document.getElementById('displayEmail').textContent = profile.email;
      document.getElementById('displayPhone').textContent = profile.phone || '';
      document.getElementById('displayAddress').textContent = profile.address || '';
      document.getElementById('displaySince').textContent = profile.memberSince || '';
      const initials = (profile.firstName||'')[0] + (profile.lastName||'')[0];
      document.getElementById('avatar').textContent = initials.toUpperCase();
    }

    // Modal controls
    const backdrop = document.getElementById('modalBackdrop');
    const form = document.getElementById('profileForm');

    function openModal(){
      const p = loadProfile();
      document.getElementById('firstName').value = p.firstName || '';
      document.getElementById('lastName').value = p.lastName || '';
      document.getElementById('email').value = p.email || '';
      document.getElementById('phone').value = p.phone || '';
      document.getElementById('address').value = p.address || '';
      backdrop.style.display = 'flex';
      backdrop.setAttribute('aria-hidden','false');
      document.getElementById('firstName').focus();
    }

    function closeModal(){
      backdrop.style.display = 'none';
      backdrop.setAttribute('aria-hidden','true');
    }

    document.getElementById('editProfile').addEventListener('click', ()=>{
      closeDropdown();
      openModal();
    });

    document.getElementById('cancelBtn').addEventListener('click', closeModal);

    backdrop.addEventListener('click', (e)=>{
      if(e.target === backdrop) closeModal();
    });

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const updated = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        address: document.getElementById('address').value.trim(),
        memberSince: loadProfile().memberSince || defaults.memberSince
      };

      saveProfile(updated);
      updateDisplay(updated);
      closeModal();
      showToast('Profile saved');
    });

    function showToast(msg='Saved'){
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.style.display = 'block';
      setTimeout(()=>{t.style.display='none'},2200);
    }

    // Dropdown controls
    const dropdown = document.getElementById('settingsDropdown');
    const toggle = document.getElementById('settingsToggle');

    function closeDropdown(){ dropdown.style.display='none'; }
    function openDropdown(){ dropdown.style.display='flex'; }

    toggle.addEventListener('click', ()=>{
      dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
    });

    document.addEventListener('click',(e)=>{
      if(!toggle.contains(e.target) && !dropdown.contains(e.target)){
        closeDropdown();
      }
    });

    // Actions for card management
    document.getElementById('blockCard').addEventListener('click', ()=>{ closeDropdown(); showToast('Card blocked'); });
    document.getElementById('replaceCard').addEventListener('click', ()=>{ closeDropdown(); showToast('Replacement card requested'); });
    document.getElementById('cardSettings').addEventListener('click', ()=>{ closeDropdown(); showToast('Opening card settings...'); });
    document.getElementById('cardLimits').addEventListener('click', ()=>{ closeDropdown(); showToast('Card limits updated'); });
    document.getElementById('reportLost').addEventListener('click', ()=>{ closeDropdown(); showToast('Lost/Stolen card reported'); });

    // Init
    updateDisplay(loadProfile());

    document.getElementById('logout').addEventListener('click', ()=>{
      if(confirm('Logout and clear local profile data? (demo only)')){
        localStorage.removeItem(storageKey);
        updateDisplay(loadProfile());
        showToast('Logged out');
      }
    });
  </script>
</body>
</html>
